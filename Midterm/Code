function Get-IOC {
    [CmdletBinding()]
    param (
        [string]$Path = "C:\Users\champuser\Downloads\IOC.html"
    )

    if (-not (Test-Path -Path $Path)) {
        Write-Error "File not found: $Path"
        return
    }

    # Read the HTML file as raw text
    $html = Get-Content -Path $Path -Raw

    # Regex to capture <tr><td>Pattern</td><td>Description</td></tr>
    $pattern = '<tr>\s*<td>(.*?)<\/td>\s*<td>(.*?)<\/td>\s*<\/tr>'
    $matches = [regex]::Matches($html, $pattern, [System.Text.RegularExpressions.RegexOptions]::Singleline)

    $results = foreach ($m in $matches) {
        [pscustomobject]@{
            Pattern     = ($m.Groups[1].Value).Trim()
            Explanation = ($m.Groups[2].Value).Trim()
        }
    }

    return $results
}

# ---------- Auto-run when the script is executed directly ----------
# If you run the script file (.\Get-IOC.ps1) it will call the function and print a table.
# If you dot-source the script (. .\Get-IOC.ps1) the function will be loaded but this call will still run,
# so if you want only to load the function for interactive use, comment out the next line.

Get-IOC -Path "C:\Users\champuser\Downloads\IOC.html" | Format-Table -AutoSize
